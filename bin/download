#!/usr/bin/env bash

set -euo pipefail

# shellcheck source=../lib/defs.sh
. "$(dirname "$0")/../lib/defs.sh"

target="$ASDF_DOWNLOAD_PATH/$jar_file"

# Workaround for some jar names not following the same pattern 
case "$ASDF_INSTALL_VERSION" in
1.3.1)
    source='https://dl.bintray.com/tigervnc/stable/VncViewer.jar'
    ;;
*)
    source="https://dl.bintray.com/tigervnc/stable/VncViewer-$ASDF_INSTALL_VERSION.jar"
    ;;
esac

[ "$ASDF_INSTALL_TYPE" = "version" ] || { echo "$plugin: can only handle version installations" >&2; exit 1; }

echo "$plugin: downloading version $ASDF_INSTALL_VERSION"
curl -L "$source" > "$target" || { rm -f "$target"; echo "$plugin: download failed" >&2; exit 1; }
